# ğŸ¯ FriendAI æ„å›¾åŒ¹é…ç³»ç»ŸæŠ€æœ¯æŒ‡å—

> **ç‰ˆæœ¬**: v2.0  
> **æ›´æ–°æ—¥æœŸ**: 2025-01-15  
> **ä½œè€…**: FriendAI Technical Team  
> **æ–‡æ¡£ç±»å‹**: æŠ€æœ¯æ¶æ„ä¸å®ç°æŒ‡å—

## ğŸ“š ç›®å½•

- [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
- [æ ¸å¿ƒæ¶æ„](#æ ¸å¿ƒæ¶æ„)
- [ç®—æ³•è¯¦è§£](#ç®—æ³•è¯¦è§£)
- [æ•°æ®ç»“æ„](#æ•°æ®ç»“æ„)
- [APIæ¥å£](#apiæ¥å£)
- [å®ç°ç»†èŠ‚](#å®ç°ç»†èŠ‚)
- [ä¼˜åŒ–ç­–ç•¥](#ä¼˜åŒ–ç­–ç•¥)
- [æ•…éšœæ’æŸ¥](#æ•…éšœæ’æŸ¥)
- [æ€§èƒ½è°ƒä¼˜](#æ€§èƒ½è°ƒä¼˜)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
- [å®é™…æ¡ˆä¾‹](#å®é™…æ¡ˆä¾‹)

---

## ç³»ç»Ÿæ¦‚è¿°

### ğŸŒŸ æ ¸å¿ƒä»·å€¼

FriendAI æ„å›¾åŒ¹é…ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäº **AI å¢å¼ºçš„æ™ºèƒ½å…³ç³»å‘ç°å¼•æ“**ï¼Œå®ƒå°†ä¼ ç»Ÿçš„è¢«åŠ¨å¼è”ç³»äººç®¡ç†å‡çº§ä¸ºä¸»åŠ¨å¼ä»·å€¼å‘ç°å¹³å°ã€‚

**æ ¸å¿ƒåˆ›æ–°ç‚¹**ï¼š
- ğŸ§  **è¯­ä¹‰ç†è§£**ï¼šé€šè¿‡æ·±åº¦å­¦ä¹ ç†è§£ç”¨æˆ·æ„å›¾çš„çœŸå®å«ä¹‰
- ğŸ¯ **ç²¾å‡†åŒ¹é…**ï¼šæ··åˆç®—æ³•ç¡®ä¿é«˜å‡†ç¡®ç‡
- ğŸ”„ **åŒå‘è§¦å‘**ï¼šæ„å›¾å’Œè”ç³»äººéƒ½èƒ½è§¦å‘åŒ¹é…
- ğŸ“Š **å¯è§£é‡Šæ€§**ï¼šæ¯ä¸ªåŒ¹é…éƒ½æœ‰æ¸…æ™°çš„ç†ç”±

### ğŸ“ˆ åº”ç”¨åœºæ™¯

| åœºæ™¯ | æ„å›¾ç¤ºä¾‹ | é¢„æœŸç»“æœ |
|------|---------|----------|
| **å•†åŠ¡æ‹“å±•** | "å¯»æ‰¾æ•™è‚²è¡Œä¸šçš„é‡‡è´­å†³ç­–è€…" | åŒ¹é…æ‰€æœ‰æ•™è‚²å…¬å¸çš„é‡‡è´­æ€»ç›‘ |
| **äººæ‰æ‹›è˜** | "æ‹›è˜æœ‰AIèƒŒæ™¯çš„é«˜çº§å·¥ç¨‹å¸ˆ" | å‘ç°ç¬¦åˆæ¡ä»¶çš„æŠ€æœ¯äººæ‰ |
| **æŠ•èµ„å¯¹æ¥** | "å¯»æ‰¾å…³æ³¨SaaSçš„å¤©ä½¿æŠ•èµ„äºº" | å®šä½ç›¸å…³é¢†åŸŸçš„æŠ•èµ„äºº |
| **èµ„æºåˆä½œ** | "æ‰¾èƒ½æä¾›æ³•å¾‹å’¨è¯¢çš„æœ‹å‹" | åŒ¹é…å¾‹å¸ˆæˆ–æ³•åŠ¡èƒŒæ™¯çš„è”ç³»äºº |

---

## æ ¸å¿ƒæ¶æ„

### ğŸ—ï¸ ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å‰ç«¯å±•ç¤ºå±‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚æ„å›¾ç®¡ç†  â”‚  â”‚åŒ¹é…ç»“æœ  â”‚  â”‚æ¨é€ä¸­å¿ƒ  â”‚  â”‚åé¦ˆæ”¶é›†  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       API ç½‘å…³å±‚                            â”‚
â”‚         RESTful API + WebSocket + æ¶ˆæ¯é˜Ÿåˆ—                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ ¸å¿ƒåŒ¹é…å¼•æ“                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚            IntentMatcher (ä¸»åŒ¹é…å™¨)                   â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚æ„å›¾å¤„ç†â”‚  â”‚è”ç³»äºº  â”‚  â”‚è¯„åˆ†è®¡ç®—â”‚  â”‚æ¨é€æ§åˆ¶â”‚ â”‚  â”‚
â”‚  â”‚  â”‚æ¨¡å—    â”‚  â”‚å¤„ç†æ¨¡å—â”‚  â”‚æ¨¡å—    â”‚  â”‚æ¨¡å—    â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚           VectorService (å‘é‡åŒ–æœåŠ¡)                  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚æ–‡æœ¬å¤„ç†â”‚  â”‚å‘é‡ç”Ÿæˆâ”‚  â”‚ç›¸ä¼¼åº¦  â”‚  â”‚è§£é‡Šç”Ÿæˆâ”‚ â”‚  â”‚
â”‚  â”‚  â”‚        â”‚  â”‚        â”‚  â”‚è®¡ç®—    â”‚  â”‚        â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ•°æ®å­˜å‚¨å±‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚æ„å›¾æ•°æ®  â”‚  â”‚åŒ¹é…è®°å½•  â”‚  â”‚å‘é‡ç´¢å¼•  â”‚  â”‚æ¨é€å†å²  â”‚  â”‚
â”‚  â”‚(SQLite) â”‚  â”‚(SQLite) â”‚  â”‚(SQLite) â”‚  â”‚(SQLite) â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”„ åŒå‘è§¦å‘æœºåˆ¶

ç³»ç»Ÿæ”¯æŒä¸¤ç§è§¦å‘æ–¹å¼ï¼Œç¡®ä¿ä¸é”™è¿‡ä»»ä½•åŒ¹é…æœºä¼šï¼š

#### 1. æ„å›¾é©±åŠ¨åŒ¹é… (Intent â†’ Profiles)

```python
è§¦å‘æ—¶æœº:
â”œâ”€â”€ åˆ›å»ºæ–°æ„å›¾
â”œâ”€â”€ ä¿®æ”¹æ„å›¾æ¡ä»¶
â”œâ”€â”€ è°ƒæ•´åŒ¹é…é˜ˆå€¼
â””â”€â”€ é‡æ–°æ¿€æ´»æ„å›¾

æ‰§è¡Œæµç¨‹:
1. æ„å›¾å‘é‡åŒ–
2. è·å–ç”¨æˆ·æ‰€æœ‰è”ç³»äºº
3. æ‰¹é‡è®¡ç®—åŒ¹é…åˆ†æ•°
4. ç­›é€‰è¶…è¿‡é˜ˆå€¼çš„ç»“æœ
5. ç”ŸæˆåŒ¹é…è§£é‡Š
6. ä¿å­˜å¹¶æ¨é€ç»“æœ
```

#### 2. è”ç³»äººé©±åŠ¨åŒ¹é… (Profile â†’ Intents)

```python
è§¦å‘æ—¶æœº:
â”œâ”€â”€ æ–°å¢è”ç³»äºº
â”œâ”€â”€ ç¼–è¾‘è”ç³»äººä¿¡æ¯
â”œâ”€â”€ AIåˆ†ææ›´æ–°ç”»åƒ
â””â”€â”€ æ‰¹é‡å¯¼å…¥è”ç³»äºº

æ‰§è¡Œæµç¨‹:
1. è”ç³»äººå‘é‡åŒ–
2. è·å–ç”¨æˆ·æ‰€æœ‰æ´»è·ƒæ„å›¾
3. æŒ‰ä¼˜å…ˆçº§æ’åº
4. è®¡ç®—ä¸æ¯ä¸ªæ„å›¾çš„åŒ¹é…åº¦
5. ç”Ÿæˆè§£é‡Šå¹¶ä¿å­˜
6. æ™ºèƒ½æ¨é€æ§åˆ¶
```

---

## ç®—æ³•è¯¦è§£

### ğŸ§® æ··åˆè¯„åˆ†ç®—æ³•

ç³»ç»Ÿé‡‡ç”¨ **"AIè¯­ä¹‰ç†è§£ + ç²¾ç¡®è§„åˆ™åŒ¹é…"** çš„æ··åˆç­–ç•¥ï¼š

#### AIå¢å¼ºæ¨¡å¼ï¼ˆæ¨èï¼‰

```python
def calculate_match_score_ai(intent, profile):
    """AIå¢å¼ºçš„åŒ¹é…è¯„åˆ†ç®—æ³•"""
    
    # 1. è¯­ä¹‰ç›¸ä¼¼åº¦ (30%)
    semantic_score = vector_service.calculate_similarity(
        intent_embedding, 
        profile_embedding
    )
    
    # 2. å…³é”®è¯åŒ¹é… (30%)
    keyword_score = calculate_keyword_match(
        intent.keywords, 
        profile.text
    )
    
    # 3. å¿…è¦æ¡ä»¶ (25%)
    required_score = evaluate_conditions(
        intent.required_conditions,
        profile,
        strict=True  # å¿…é¡»å…¨éƒ¨æ»¡è¶³
    )
    
    # 4. ä¼˜é€‰æ¡ä»¶ (15%)
    preferred_score = evaluate_conditions(
        intent.preferred_conditions,
        profile,
        strict=False  # éƒ¨åˆ†æ»¡è¶³å³å¯
    )
    
    # åŠ æƒè®¡ç®—
    final_score = (
        semantic_score * 0.30 +
        keyword_score * 0.30 +
        required_score * 0.25 +
        preferred_score * 0.15
    )
    
    return final_score
```

#### åŸºç¡€è§„åˆ™æ¨¡å¼ï¼ˆé™çº§æ–¹æ¡ˆï¼‰

```python
def calculate_match_score_basic(intent, profile):
    """åŸºç¡€è§„åˆ™åŒ¹é…ç®—æ³•ï¼ˆAIä¸å¯ç”¨æ—¶ï¼‰"""
    
    # 1. å…³é”®è¯åŒ¹é… (40%)
    keyword_score = calculate_keyword_match(
        intent.keywords,
        profile.text
    )
    
    # 2. å¿…è¦æ¡ä»¶ (40%)
    required_score = evaluate_conditions(
        intent.required_conditions,
        profile,
        strict=True
    )
    
    # 3. ä¼˜é€‰æ¡ä»¶ (20%)
    preferred_score = evaluate_conditions(
        intent.preferred_conditions,
        profile,
        strict=False
    )
    
    # åŠ æƒè®¡ç®—
    final_score = (
        keyword_score * 0.40 +
        required_score * 0.40 +
        preferred_score * 0.20
    )
    
    return final_score
```

### ğŸ” æ¡ä»¶åŒ¹é…å¼•æ“

æ”¯æŒå¤šç§æ¡ä»¶æ“ä½œç¬¦ï¼Œçµæ´»å®šä¹‰åŒ¹é…è§„åˆ™ï¼š

```python
class ConditionEvaluator:
    """æ¡ä»¶è¯„ä¼°å™¨"""
    
    OPERATORS = {
        'eq': lambda a, b: a == b,                    # ç›¸ç­‰
        'contains': lambda a, b: b in a,              # åŒ…å«
        'in': lambda a, b: a in b,                    # åœ¨åˆ—è¡¨ä¸­
        'gt': lambda a, b: float(a) > float(b),       # å¤§äº
        'lt': lambda a, b: float(a) < float(b),       # å°äº
        'between': lambda a, b: b[0] <= float(a) <= b[1],  # åŒºé—´
        'regex': lambda a, b: re.match(b, a) is not None,  # æ­£åˆ™
        'not': lambda a, b: a != b,                   # ä¸ç­‰äº
        'startswith': lambda a, b: a.startswith(b),   # å¼€å¤´åŒ¹é…
        'endswith': lambda a, b: a.endswith(b)        # ç»“å°¾åŒ¹é…
    }
    
    def evaluate(self, condition, profile):
        """è¯„ä¼°å•ä¸ªæ¡ä»¶"""
        field = condition['field']
        operator = condition['operator']
        expected = condition['value']
        
        # è·å–å­—æ®µå€¼
        actual = self.get_field_value(profile, field)
        
        # åº”ç”¨æ“ä½œç¬¦
        if operator in self.OPERATORS:
            return self.OPERATORS[operator](actual, expected)
        
        return False
```

### ğŸ§  å‘é‡åŒ–ç­–ç•¥

#### æ„å›¾å‘é‡åŒ–

```python
def vectorize_intent(intent):
    """å°†æ„å›¾è½¬æ¢ä¸ºå‘é‡è¡¨ç¤º"""
    
    # æ„å»ºæ–‡æœ¬è¡¨ç¤º
    text_parts = [
        f"æ„å›¾ï¼š{intent.name}",
        f"æè¿°ï¼š{intent.description}",
        f"å…³é”®è¯ï¼š{' '.join(intent.keywords)}",
    ]
    
    # æ·»åŠ æ¡ä»¶ä¿¡æ¯
    for condition in intent.required_conditions:
        text_parts.append(f"å¿…é¡»{condition.field}ï¼š{condition.value}")
    
    for condition in intent.preferred_conditions:
        text_parts.append(f"æœŸæœ›{condition.field}ï¼š{condition.value}")
    
    # ç”Ÿæˆå‘é‡
    text = '\n'.join(text_parts)
    embedding = qwen_api.get_embedding(text, model='text-embedding-v3')
    
    return embedding  # 1536ç»´å‘é‡
```

#### è”ç³»äººå‘é‡åŒ–

```python
def vectorize_profile(profile):
    """å°†è”ç³»äººä¿¡æ¯è½¬æ¢ä¸ºå‘é‡è¡¨ç¤º"""
    
    # æ„å»ºæ–‡æœ¬è¡¨ç¤º
    text_parts = []
    
    # åŸºæœ¬ä¿¡æ¯
    for field in ['name', 'company', 'position', 'location']:
        if profile.get(field):
            text_parts.append(f"{field}ï¼š{profile[field]}")
    
    # æ‰©å±•ä¿¡æ¯
    if profile.get('tags'):
        text_parts.append(f"æ ‡ç­¾ï¼š{' '.join(profile['tags'])}")
    
    if profile.get('ai_summary'):
        text_parts.append(f"ç®€ä»‹ï¼š{profile['ai_summary']}")
    
    # ç”Ÿæˆå‘é‡
    text = '\n'.join(text_parts)
    embedding = qwen_api.get_embedding(text, model='text-embedding-v3')
    
    return embedding  # 1536ç»´å‘é‡
```

---

## æ•°æ®ç»“æ„

### ğŸ“Š æ•°æ®åº“è®¾è®¡

#### 1. ç”¨æˆ·æ„å›¾è¡¨ (user_intents)

```sql
CREATE TABLE user_intents (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id TEXT NOT NULL,                    -- å¾®ä¿¡ç”¨æˆ·ID
    name TEXT NOT NULL,                        -- æ„å›¾åç§°
    description TEXT,                          -- è‡ªç„¶è¯­è¨€æè¿°
    type TEXT DEFAULT 'general',              -- æ„å›¾ç±»å‹
    
    -- æ¡ä»¶å­˜å‚¨ï¼ˆJSONæ ¼å¼ï¼‰
    conditions TEXT DEFAULT '{}',             -- åŒ¹é…æ¡ä»¶
    
    -- å‘é‡æ•°æ®
    embedding BLOB,                           -- 1536ç»´å‘é‡
    embedding_model TEXT DEFAULT 'qwen-v3',   -- å‘é‡æ¨¡å‹ç‰ˆæœ¬
    
    -- é…ç½®é¡¹
    threshold REAL DEFAULT 0.7,               -- åŒ¹é…é˜ˆå€¼(0-1)
    priority INTEGER DEFAULT 5,               -- ä¼˜å…ˆçº§(1-10)
    max_push_per_day INTEGER DEFAULT 5,       -- æ¯æ—¥æ¨é€ä¸Šé™
    
    -- çŠ¶æ€æ§åˆ¶
    status TEXT DEFAULT 'active',             -- active/paused/expired
    expire_at TIMESTAMP,                      -- è¿‡æœŸæ—¶é—´
    
    -- ç»Ÿè®¡æ•°æ®
    match_count INTEGER DEFAULT 0,            -- ç´¯è®¡åŒ¹é…æ•°
    success_count INTEGER DEFAULT 0,          -- æˆåŠŸåŒ¹é…æ•°
    last_match_at TIMESTAMP,                  -- æœ€ååŒ¹é…æ—¶é—´
    
    -- æ—¶é—´æˆ³
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    INDEX idx_user_status (user_id, status),
    INDEX idx_expire (expire_at)
);
```

#### 2. åŒ¹é…è®°å½•è¡¨ (intent_matches)

```sql
CREATE TABLE intent_matches (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    intent_id INTEGER NOT NULL,
    profile_id INTEGER NOT NULL,
    user_id TEXT NOT NULL,
    
    -- åŒ¹é…è¯¦æƒ…
    match_score REAL NOT NULL,                -- åŒ¹é…åˆ†æ•°(0-1)
    score_details TEXT,                       -- å„ç»´åº¦åˆ†æ•°æ˜ç»†(JSON)
    matched_conditions TEXT,                  -- åŒ¹é…çš„æ¡ä»¶åˆ—è¡¨(JSON)
    explanation TEXT,                         -- åŒ¹é…è§£é‡Š
    
    -- æ¨é€çŠ¶æ€
    is_pushed BOOLEAN DEFAULT FALSE,          -- æ˜¯å¦å·²æ¨é€
    pushed_at TIMESTAMP,                      -- æ¨é€æ—¶é—´
    push_channel TEXT,                        -- æ¨é€æ¸ é“
    
    -- ç”¨æˆ·åé¦ˆ
    user_feedback TEXT,                       -- positive/negative/ignored
    feedback_at TIMESTAMP,                    -- åé¦ˆæ—¶é—´
    feedback_note TEXT,                       -- åé¦ˆå¤‡æ³¨
    
    -- çŠ¶æ€
    status TEXT DEFAULT 'pending',            -- pending/pushed/archived
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    FOREIGN KEY (intent_id) REFERENCES user_intents(id) ON DELETE CASCADE,
    INDEX idx_user_matches (user_id, status),
    INDEX idx_intent_matches (intent_id, match_score DESC),
    UNIQUE idx_unique_match (intent_id, profile_id)
);
```

#### 3. å‘é‡ç´¢å¼•è¡¨ (vector_index)

```sql
CREATE TABLE vector_index (
    id TEXT PRIMARY KEY,                      -- æ ¼å¼ï¼štype_entityid
    vector_type TEXT NOT NULL,                -- intent/profile
    entity_id INTEGER NOT NULL,               -- å…³è”çš„å®ä½“ID
    user_id TEXT NOT NULL,                    -- æ‰€å±ç”¨æˆ·
    embedding BLOB NOT NULL,                  -- å‘é‡æ•°æ®
    metadata TEXT,                            -- å…ƒæ•°æ®(JSON)
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    INDEX idx_vector_type (vector_type, user_id),
    INDEX idx_entity (entity_id)
);
```

### ğŸ“ æ¡ä»¶æ•°æ®ç»“æ„

```typescript
interface IntentConditions {
  // å…³é”®è¯åˆ—è¡¨
  keywords: string[];
  
  // å¿…è¦æ¡ä»¶ï¼ˆANDé€»è¾‘ï¼‰
  required: Condition[];
  
  // ä¼˜é€‰æ¡ä»¶ï¼ˆåŠ åˆ†é¡¹ï¼‰
  preferred: Condition[];
  
  // æ’é™¤æ¡ä»¶ï¼ˆé»‘åå•ï¼‰
  exclude: Condition[];
}

interface Condition {
  field: string;        // å­—æ®µå
  operator: string;     // æ“ä½œç¬¦
  value: any;          // åŒ¹é…å€¼
  weight?: number;     // æƒé‡(0-1)
}
```

---

## APIæ¥å£

### ğŸ”Œ RESTful API

#### 1. æ„å›¾ç®¡ç†

```bash
# åˆ›å»ºæ„å›¾
POST /api/intents
{
  "name": "å¯»æ‰¾AIé¢†åŸŸæŠ•èµ„äºº",
  "description": "å¯»æ‰¾å…³æ³¨äººå·¥æ™ºèƒ½é¢†åŸŸçš„å¤©ä½¿æŠ•èµ„äºº",
  "conditions": {
    "keywords": ["æŠ•èµ„", "AI", "å¤©ä½¿"],
    "required": [
      {"field": "position", "operator": "contains", "value": "æŠ•èµ„"}
    ],
    "preferred": [
      {"field": "location", "operator": "in", "value": ["åŒ—äº¬", "ä¸Šæµ·"]}
    ]
  },
  "threshold": 0.6,
  "priority": 8
}

# è·å–æ„å›¾åˆ—è¡¨
GET /api/intents?status=active&page=1&size=10

# æ›´æ–°æ„å›¾
PUT /api/intents/{id}

# åˆ é™¤æ„å›¾
DELETE /api/intents/{id}

# è§¦å‘åŒ¹é…
POST /api/intents/{id}/match
```

#### 2. åŒ¹é…ç»“æœ

```bash
# è·å–åŒ¹é…ç»“æœ
GET /api/matches?intent_id={id}&min_score=0.7

# è·å–åŒ¹é…è¯¦æƒ…
GET /api/matches/{id}

# ç”¨æˆ·åé¦ˆ
PUT /api/matches/{id}/feedback
{
  "feedback": "positive",
  "note": "éå¸¸å‡†ç¡®ï¼Œå·²ç»è”ç³»ä¸Šäº†"
}

# æ‰¹é‡æ“ä½œ
POST /api/matches/batch
{
  "ids": [1, 2, 3],
  "action": "archive"
}
```

#### 3. å‘é‡åŒ–æœåŠ¡

```bash
# ç”Ÿæˆæ„å›¾å‘é‡
POST /api/ai/vectorize-intent/{id}

# ç”Ÿæˆè”ç³»äººå‘é‡
POST /api/ai/vectorize-profile/{id}

# è®¡ç®—ç›¸ä¼¼åº¦
POST /api/ai/similarity
{
  "intent_id": 1,
  "profile_id": 2
}
```

---

## å®ç°ç»†èŠ‚

### ğŸ”§ æ ¸å¿ƒç±»è®¾è®¡

#### IntentMatcher ç±»

```python
class IntentMatcher:
    """æ„å›¾åŒ¹é…å¼•æ“æ ¸å¿ƒç±»"""
    
    def __init__(self, db_path: str, use_ai: bool = True):
        self.db_path = db_path
        self.use_ai = use_ai
        self.vector_service = None
        
        if self.use_ai:
            try:
                from .vector_service import vector_service
                self.vector_service = vector_service
                logger.info("âœ… AIæ¨¡å¼å·²å¯ç”¨")
            except ImportError:
                logger.warning("âš ï¸ AIä¾èµ–æœªå®‰è£…ï¼Œé™çº§åˆ°è§„åˆ™æ¨¡å¼")
                self.use_ai = False
    
    async def match_intent_with_profiles(
        self, 
        intent_id: int, 
        user_id: str
    ) -> List[Dict]:
        """å°†æ„å›¾ä¸æ‰€æœ‰è”ç³»äººåŒ¹é…"""
        # å®ç°ä»£ç ...
    
    async def match_profile_with_intents(
        self,
        profile_id: int,
        user_id: str
    ) -> List[Dict]:
        """å°†è”ç³»äººä¸æ‰€æœ‰æ„å›¾åŒ¹é…"""
        # å®ç°ä»£ç ...
```

#### VectorService ç±»

```python
class VectorService:
    """å‘é‡åŒ–æœåŠ¡ç±»"""
    
    def __init__(self):
        self.api_key = os.getenv('QWEN_API_KEY')
        self.api_endpoint = 'https://dashscope.aliyuncs.com/compatible-mode/v1'
        self.embedding_model = 'text-embedding-v3'
        self.dimension = 1536
    
    async def get_embedding(self, text: str) -> List[float]:
        """è·å–æ–‡æœ¬å‘é‡"""
        # è°ƒç”¨é€šä¹‰åƒé—®API
        # è¿”å›1536ç»´å‘é‡
    
    def calculate_similarity(
        self, 
        vec1: List[float], 
        vec2: List[float]
    ) -> float:
        """è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦"""
        # ä½¿ç”¨numpyè®¡ç®—
        # è¿”å›0-1ä¹‹é—´çš„ç›¸ä¼¼åº¦
```

### ğŸ¯ åŒ¹é…æµç¨‹

```python
async def complete_matching_flow(intent, user_id):
    """å®Œæ•´çš„åŒ¹é…æµç¨‹"""
    
    # 1. å‡†å¤‡é˜¶æ®µ
    intent_vector = await vectorize_intent(intent)
    profiles = get_user_profiles(user_id)
    
    # 2. åŒ¹é…é˜¶æ®µ
    matches = []
    for profile in profiles:
        # è®¡ç®—åŒ¹é…åˆ†æ•°
        score = await calculate_match_score(intent, profile)
        
        # æ£€æŸ¥é˜ˆå€¼
        if score >= intent.threshold:
            # ç”Ÿæˆè§£é‡Š
            explanation = await generate_explanation(
                intent, profile, score
            )
            
            # æ·»åŠ åˆ°ç»“æœ
            matches.append({
                'profile': profile,
                'score': score,
                'explanation': explanation
            })
    
    # 3. åå¤„ç†é˜¶æ®µ
    matches = sort_and_deduplicate(matches)
    save_matches_to_db(matches)
    
    # 4. æ¨é€é˜¶æ®µ
    if should_push(user_id, intent):
        await push_notifications(user_id, matches)
    
    return matches
```

---

## ä¼˜åŒ–ç­–ç•¥

### ğŸ“ˆ æé«˜åŒ¹é…å‡†ç¡®ç‡

#### 1. æ„å›¾ä¼˜åŒ–

```python
# âŒ ä¸å¥½çš„æ„å›¾è®¾ç½®
{
    "name": "æ‰¾äºº",
    "keywords": ["åˆä½œ", "é¡¹ç›®", "ä¸šåŠ¡"],  # å¤ªæ³›æ³›
    "threshold": 0.9  # é˜ˆå€¼è¿‡é«˜
}

# âœ… ä¼˜åŒ–åçš„æ„å›¾
{
    "name": "å¯»æ‰¾AIæŠ€æœ¯åˆä¼™äºº",
    "description": "éœ€è¦æœ‰æ·±åº¦å­¦ä¹ èƒŒæ™¯çš„æŠ€æœ¯è´Ÿè´£äººï¼Œæœ€å¥½æœ‰åˆ›ä¸šç»éªŒ",
    "keywords": ["æ·±åº¦å­¦ä¹ ", "CTO", "åˆ›ä¸š"],  # ç²¾å‡†å…³é”®è¯
    "required": [],  # ä¸è®¾è¿‡ä¸¥çš„å¿…è¦æ¡ä»¶
    "preferred": [
        {"field": "position", "operator": "contains", "value": "æŠ€æœ¯"},
        {"field": "company", "operator": "contains", "value": "AI"}
    ],
    "threshold": 0.5  # åˆç†é˜ˆå€¼
}
```

#### 2. æ•°æ®è´¨é‡æå‡

```python
# è”ç³»äººä¿¡æ¯å®Œæ•´åº¦æ£€æŸ¥
def calculate_profile_completeness(profile):
    """è®¡ç®—è”ç³»äººä¿¡æ¯å®Œæ•´åº¦"""
    
    required_fields = [
        'name', 'company', 'position', 
        'location', 'phone', 'wechat_id'
    ]
    
    optional_fields = [
        'education', 'tags', 'ai_summary',
        'age', 'gender', 'personality'
    ]
    
    # è®¡ç®—å¾—åˆ†
    required_score = sum(
        1 for f in required_fields 
        if profile.get(f) and profile[f] != 'æœªçŸ¥'
    ) / len(required_fields)
    
    optional_score = sum(
        1 for f in optional_fields 
        if profile.get(f)
    ) / len(optional_fields)
    
    # åŠ æƒè®¡ç®—
    completeness = required_score * 0.7 + optional_score * 0.3
    
    return completeness  # 0-1ä¹‹é—´
```

### âš¡ æ€§èƒ½ä¼˜åŒ–

#### 1. å‘é‡ç¼“å­˜ç­–ç•¥

```python
class VectorCache:
    """å‘é‡ç¼“å­˜ç®¡ç†"""
    
    def __init__(self, ttl=3600):
        self.cache = {}
        self.ttl = ttl
    
    async def get_or_compute(self, key, compute_func):
        """è·å–æˆ–è®¡ç®—å‘é‡"""
        
        # æ£€æŸ¥ç¼“å­˜
        if key in self.cache:
            entry = self.cache[key]
            if time.time() - entry['time'] < self.ttl:
                return entry['vector']
        
        # è®¡ç®—æ–°å‘é‡
        vector = await compute_func()
        
        # æ›´æ–°ç¼“å­˜
        self.cache[key] = {
            'vector': vector,
            'time': time.time()
        }
        
        return vector
```

#### 2. æ‰¹é‡å¤„ç†ä¼˜åŒ–

```python
async def batch_match_profiles(intent, profiles, batch_size=10):
    """æ‰¹é‡åŒ¹é…ä¼˜åŒ–"""
    
    matches = []
    
    # åˆ†æ‰¹å¤„ç†
    for i in range(0, len(profiles), batch_size):
        batch = profiles[i:i+batch_size]
        
        # å¹¶å‘è®¡ç®—
        tasks = [
            calculate_match_score(intent, profile)
            for profile in batch
        ]
        
        scores = await asyncio.gather(*tasks)
        
        # æ”¶é›†ç»“æœ
        for profile, score in zip(batch, scores):
            if score >= intent.threshold:
                matches.append((profile, score))
    
    return matches
```

---

## æ•…éšœæ’æŸ¥

### ğŸ” å¸¸è§é—®é¢˜

#### 1. åŒ¹é…åˆ†æ•°è¿‡ä½

**ç—‡çŠ¶**ï¼šæ‰€æœ‰åŒ¹é…åˆ†æ•°éƒ½åœ¨0.3ä»¥ä¸‹

**åŸå› åˆ†æ**ï¼š
- å…³é”®è¯è®¾ç½®è¿‡å¤šæˆ–è¿‡äºå®½æ³›
- å¿…è¦æ¡ä»¶è¿‡äºä¸¥æ ¼
- å‘é‡åŒ–æœåŠ¡æœªæ­£å¸¸å·¥ä½œ

**è§£å†³æ–¹æ¡ˆ**ï¼š
```python
# è¯Šæ–­è„šæœ¬
def diagnose_low_scores(intent_id, user_id):
    """è¯Šæ–­ä½åˆ†é—®é¢˜"""
    
    # 1. æ£€æŸ¥å‘é‡æœåŠ¡
    if not vector_service.is_available():
        print("âŒ å‘é‡æœåŠ¡ä¸å¯ç”¨")
        return
    
    # 2. åˆ†æå…³é”®è¯
    intent = get_intent(intent_id)
    if len(intent.keywords) > 5:
        print("âš ï¸ å…³é”®è¯è¿‡å¤šï¼Œå»ºè®®å‡å°‘åˆ°3-5ä¸ª")
    
    # 3. æ£€æŸ¥å¿…è¦æ¡ä»¶
    if len(intent.required_conditions) > 2:
        print("âš ï¸ å¿…è¦æ¡ä»¶è¿‡å¤šï¼Œå»ºè®®æ”¹ä¸ºä¼˜é€‰æ¡ä»¶")
    
    # 4. æµ‹è¯•å•é¡¹å¾—åˆ†
    test_profile = get_sample_profile(user_id)
    scores = {
        'semantic': calculate_semantic_score(intent, test_profile),
        'keyword': calculate_keyword_score(intent, test_profile),
        'required': calculate_required_score(intent, test_profile),
        'preferred': calculate_preferred_score(intent, test_profile)
    }
    
    print(f"å„é¡¹å¾—åˆ†: {scores}")
    
    # 5. ç»™å‡ºå»ºè®®
    if scores['semantic'] < 0.3:
        print("ğŸ’¡ å»ºè®®ï¼šä¼˜åŒ–æ„å›¾æè¿°ï¼Œä½¿ç”¨æ›´å…·ä½“çš„è¡¨è¿°")
    if scores['keyword'] < 0.3:
        print("ğŸ’¡ å»ºè®®ï¼šå‡å°‘å…³é”®è¯æ•°é‡ï¼Œä½¿ç”¨æ›´ç²¾å‡†çš„è¯æ±‡")
```

#### 2. AIæœåŠ¡ä¸å¯ç”¨

**ç—‡çŠ¶**ï¼šæç¤º"å‘é‡åŒ–å¤±è´¥"æˆ–"AIæœåŠ¡ä¸å¯ç”¨"

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# 1. æ£€æŸ¥APIå¯†é’¥
echo $QWEN_API_KEY

# 2. æµ‹è¯•APIè¿æ¥
curl -X POST https://dashscope.aliyuncs.com/compatible-mode/v1/embeddings \
  -H "Authorization: Bearer $QWEN_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{"model":"text-embedding-v3","input":"test"}'

# 3. æ£€æŸ¥ä¾èµ–
pip list | grep -E "numpy|scipy|aiohttp"

# 4. é‡æ–°å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

#### 3. æ¨é€æœªç”Ÿæ•ˆ

**ç—‡çŠ¶**ï¼šåŒ¹é…æˆåŠŸä½†æ²¡æœ‰æ”¶åˆ°æ¨é€

**è¯Šæ–­æµç¨‹**ï¼š
```python
def check_push_issues(user_id, match_id):
    """æ£€æŸ¥æ¨é€é—®é¢˜"""
    
    # 1. æ£€æŸ¥æ¨é€åå¥½
    prefs = get_push_preferences(user_id)
    if not prefs.enable_push:
        print("âŒ ç”¨æˆ·å·²ç¦ç”¨æ¨é€")
        return
    
    # 2. æ£€æŸ¥é™é»˜æ—¶æ®µ
    if is_quiet_hours(user_id):
        print("â° å½“å‰åœ¨é™é»˜æ—¶æ®µ")
        return
    
    # 3. æ£€æŸ¥æ¨é€é™åˆ¶
    today_count = get_today_push_count(user_id)
    if today_count >= prefs.daily_limit:
        print(f"ğŸ“Š ä»Šæ—¥å·²æ¨é€{today_count}æ¬¡ï¼Œè¾¾åˆ°ä¸Šé™")
        return
    
    # 4. æ£€æŸ¥æ¨é€å†å²
    push_record = get_push_record(match_id)
    if push_record:
        print(f"âœ… å·²æ¨é€äº: {push_record.pushed_at}")
    else:
        print("âŒ æœªæ‰¾åˆ°æ¨é€è®°å½•ï¼Œå¯èƒ½æ¨é€å¤±è´¥")
```

---

## æ€§èƒ½è°ƒä¼˜

### ğŸš€ ä¼˜åŒ–å»ºè®®

#### 1. æ•°æ®åº“ä¼˜åŒ–

```sql
-- æ·»åŠ å¤åˆç´¢å¼•
CREATE INDEX idx_intent_user_status 
ON user_intents(user_id, status, priority DESC);

CREATE INDEX idx_match_score 
ON intent_matches(user_id, match_score DESC);

-- å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®
DELETE FROM intent_matches 
WHERE created_at < datetime('now', '-90 days')
AND status = 'archived';

-- ä¼˜åŒ–æŸ¥è¯¢
EXPLAIN QUERY PLAN
SELECT * FROM intent_matches
WHERE user_id = ? AND match_score > 0.7
ORDER BY match_score DESC;
```

#### 2. ç¼“å­˜ä¼˜åŒ–

```python
class MatchingCache:
    """åŒ¹é…ç»“æœç¼“å­˜"""
    
    def __init__(self, redis_client):
        self.redis = redis_client
        self.ttl = 300  # 5åˆ†é’Ÿ
    
    def get_cached_matches(self, intent_id, profile_ids):
        """è·å–ç¼“å­˜çš„åŒ¹é…ç»“æœ"""
        
        cache_keys = [
            f"match:{intent_id}:{pid}" 
            for pid in profile_ids
        ]
        
        # æ‰¹é‡è·å–
        results = self.redis.mget(cache_keys)
        
        # è§£æç»“æœ
        matches = []
        uncached_ids = []
        
        for pid, result in zip(profile_ids, results):
            if result:
                matches.append(json.loads(result))
            else:
                uncached_ids.append(pid)
        
        return matches, uncached_ids
```

#### 3. å¹¶å‘ä¼˜åŒ–

```python
async def concurrent_matching(intent, profiles):
    """å¹¶å‘åŒ¹é…ä¼˜åŒ–"""
    
    # åˆ›å»ºä¿¡å·é‡é™åˆ¶å¹¶å‘æ•°
    semaphore = asyncio.Semaphore(10)
    
    async def match_with_limit(profile):
        async with semaphore:
            return await calculate_match_score(intent, profile)
    
    # åˆ›å»ºä»»åŠ¡
    tasks = [
        match_with_limit(profile) 
        for profile in profiles
    ]
    
    # å¹¶å‘æ‰§è¡Œ
    scores = await asyncio.gather(*tasks)
    
    # æ”¶é›†ç»“æœ
    results = [
        (profile, score)
        for profile, score in zip(profiles, scores)
        if score >= intent.threshold
    ]
    
    return results
```

---

## æœ€ä½³å®è·µ

### âœ… DO - æ¨èåšæ³•

1. **æ„å›¾è®¾ç½®**
   - âœ… ä½¿ç”¨3-5ä¸ªç²¾å‡†å…³é”®è¯
   - âœ… æä¾›è¯¦ç»†çš„æ„å›¾æè¿°
   - âœ… ä¼˜å…ˆä½¿ç”¨ä¼˜é€‰æ¡ä»¶è€Œéå¿…è¦æ¡ä»¶
   - âœ… è®¾ç½®åˆç†çš„åŒ¹é…é˜ˆå€¼ï¼ˆ0.4-0.6ï¼‰

2. **æ•°æ®ç®¡ç†**
   - âœ… ä¿æŒè”ç³»äººä¿¡æ¯å®Œæ•´
   - âœ… å®šæœŸæ›´æ–°è”ç³»äººç”»åƒ
   - âœ… ä½¿ç”¨æ ‡ç­¾ç³»ç»Ÿå¢å¼ºåŒ¹é…
   - âœ… åŠæ—¶å¤„ç†åŒ¹é…åé¦ˆ

3. **æ€§èƒ½ä¼˜åŒ–**
   - âœ… å¯ç”¨å‘é‡ç¼“å­˜
   - âœ… ä½¿ç”¨æ‰¹é‡æ“ä½œ
   - âœ… å®šæœŸæ¸…ç†å†å²æ•°æ®
   - âœ… ç›‘æ§APIè°ƒç”¨é¢‘ç‡

### âŒ DON'T - é¿å…åšæ³•

1. **æ„å›¾è®¾ç½®**
   - âŒ è®¾ç½®è¿‡å¤šå…³é”®è¯ï¼ˆ>7ä¸ªï¼‰
   - âŒ ä½¿ç”¨è¿‡äºå®½æ³›çš„è¯æ±‡
   - âŒ è®¾ç½®è¿‡é«˜çš„é˜ˆå€¼ï¼ˆ>0.8ï¼‰
   - âŒ è¿‡åº¦ä¾èµ–å¿…è¦æ¡ä»¶

2. **ç³»ç»Ÿä½¿ç”¨**
   - âŒ é¢‘ç¹ä¿®æ”¹æ„å›¾æ¡ä»¶
   - âŒ å¿½è§†ç”¨æˆ·åé¦ˆ
   - âŒ å…³é—­AIå¢å¼ºæ¨¡å¼
   - âŒ ä¸è®¾ç½®æ¨é€é™åˆ¶

---

## å®é™…æ¡ˆä¾‹

### ğŸ“‹ æ¡ˆä¾‹1ï¼šæ‹›è˜åœºæ™¯

**éœ€æ±‚**ï¼šå¯»æ‰¾èµ„æ·±å‰ç«¯å·¥ç¨‹å¸ˆ

**æ„å›¾é…ç½®**ï¼š
```json
{
  "name": "æ‹›è˜èµ„æ·±å‰ç«¯å·¥ç¨‹å¸ˆ",
  "description": "å¯»æ‰¾æœ‰5å¹´ä»¥ä¸Šç»éªŒçš„å‰ç«¯å·¥ç¨‹å¸ˆï¼Œç²¾é€šReactå’ŒVueï¼Œæœ‰å¤§å‹é¡¹ç›®ç»éªŒ",
  "conditions": {
    "keywords": ["å‰ç«¯", "React", "Vue", "JavaScript"],
    "required": [
      {"field": "position", "operator": "contains", "value": "å‰ç«¯"},
      {"field": "experience_years", "operator": "gt", "value": 5}
    ],
    "preferred": [
      {"field": "company", "operator": "contains", "value": "å¤§å‚"},
      {"field": "education", "operator": "contains", "value": "æœ¬ç§‘"}
    ]
  },
  "threshold": 0.6,
  "priority": 9
}
```

**åŒ¹é…ç»“æœ**ï¼š
- å¼ ä¸‰ï¼šå‰ç«¯æŠ€æœ¯ä¸“å®¶ï¼Œå­—èŠ‚è·³åŠ¨ï¼Œ7å¹´ç»éªŒ â†’ åŒ¹é…åº¦ 0.85
- æå››ï¼šé«˜çº§å‰ç«¯å·¥ç¨‹å¸ˆï¼Œé˜¿é‡Œå·´å·´ï¼Œ5å¹´ç»éªŒ â†’ åŒ¹é…åº¦ 0.78
- ç‹äº”ï¼šå‰ç«¯å¼€å‘ï¼Œåˆ›ä¸šå…¬å¸ï¼Œ3å¹´ç»éªŒ â†’ åŒ¹é…åº¦ 0.42ï¼ˆä½äºé˜ˆå€¼ï¼‰

### ğŸ“‹ æ¡ˆä¾‹2ï¼šæŠ•èµ„å¯¹æ¥

**éœ€æ±‚**ï¼šå¯»æ‰¾å…³æ³¨æ•™è‚²ç§‘æŠ€çš„æŠ•èµ„äºº

**æ„å›¾é…ç½®**ï¼š
```json
{
  "name": "æ•™è‚²ç§‘æŠ€é¢†åŸŸæŠ•èµ„äºº",
  "description": "å¯»æ‰¾å…³æ³¨æ•™è‚²ç§‘æŠ€ã€åœ¨çº¿æ•™è‚²ã€AIæ•™è‚²çš„æ—©æœŸæŠ•èµ„äºº",
  "conditions": {
    "keywords": ["æŠ•èµ„", "æ•™è‚²", "ç§‘æŠ€", "å¤©ä½¿"],
    "preferred": [
      {"field": "position", "operator": "contains", "value": "æŠ•èµ„"},
      {"field": "company", "operator": "contains", "value": "èµ„æœ¬"},
      {"field": "tags", "operator": "contains", "value": "æ•™è‚²"}
    ]
  },
  "threshold": 0.5,
  "priority": 8
}
```

**ä¼˜åŒ–æŠ€å·§**ï¼š
1. ä¸è®¾å¿…è¦æ¡ä»¶ï¼Œå¢åŠ åŒ¹é…çµæ´»æ€§
2. å…³é”®è¯åŒ…å«è¡Œä¸šæœ¯è¯­
3. åˆ©ç”¨æ ‡ç­¾ç³»ç»Ÿå¢å¼ºåŒ¹é…
4. é€‚ä¸­çš„é˜ˆå€¼è®¾ç½®

### ğŸ“‹ æ¡ˆä¾‹3ï¼šå•†åŠ¡åˆä½œ

**éœ€æ±‚**ï¼šå¯»æ‰¾ç”µå•†å¹³å°åˆä½œä¼™ä¼´

**è¿­ä»£ä¼˜åŒ–è¿‡ç¨‹**ï¼š

```python
# ç¬¬ä¸€ç‰ˆï¼ˆåŒ¹é…ç‡ä½ï¼‰
v1 = {
    "keywords": ["ç”µå•†", "å¹³å°", "åˆä½œ", "å•†åŠ¡", "BD", "æ¸ é“", "é”€å”®"],
    "threshold": 0.7
}
# ç»“æœï¼šåªåŒ¹é…åˆ°2äºº

# ç¬¬äºŒç‰ˆï¼ˆä¼˜åŒ–å…³é”®è¯ï¼‰
v2 = {
    "keywords": ["ç”µå•†", "æ·˜å®", "äº¬ä¸œ"],
    "preferred": [
        {"field": "company", "operator": "contains", "value": "ç”µå•†"}
    ],
    "threshold": 0.5
}
# ç»“æœï¼šåŒ¹é…åˆ°8äºº

# ç¬¬ä¸‰ç‰ˆï¼ˆåŠ å…¥AIç†è§£ï¼‰
v3 = {
    "description": "å¯»æ‰¾åœ¨ç”µå•†å¹³å°å·¥ä½œçš„å•†åŠ¡åˆä½œè´Ÿè´£äººï¼Œæœ‰æ¸ é“èµ„æº",
    "keywords": ["ç”µå•†", "BD", "æ¸ é“"],
    "threshold": 0.4
}
# ç»“æœï¼šåŒ¹é…åˆ°15äººï¼Œè´¨é‡æå‡
```

---

## ğŸ”® æœªæ¥å±•æœ›

### å‘å±•è·¯çº¿å›¾

#### Phase 1ï¼šåŸºç¡€ä¼˜åŒ–ï¼ˆå½“å‰ï¼‰
- âœ… AIè¯­ä¹‰ç†è§£é›†æˆ
- âœ… åŒå‘è§¦å‘æœºåˆ¶
- âœ… æ™ºèƒ½æ¨é€æ§åˆ¶
- â³ ç”¨æˆ·åé¦ˆå­¦ä¹ 

#### Phase 2ï¼šæ€§èƒ½æå‡ï¼ˆ3ä¸ªæœˆï¼‰
- â³ å‘é‡æ•°æ®åº“é›†æˆï¼ˆFaiss/Milvusï¼‰
- â³ å®æ—¶åŒ¹é…æ¨é€ï¼ˆWebSocketï¼‰
- â³ æ‰¹é‡å¼‚æ­¥å¤„ç†
- â³ åˆ†å¸ƒå¼è®¡ç®—æ”¯æŒ

#### Phase 3ï¼šæ™ºèƒ½è¿›åŒ–ï¼ˆ6ä¸ªæœˆï¼‰
- â³ ä¸ªæ€§åŒ–æƒé‡å­¦ä¹ 
- â³ æ„å›¾è‡ªåŠ¨ä¼˜åŒ–
- â³ å…³ç³»å›¾è°±åˆ†æ
- â³ é¢„æµ‹æ€§åŒ¹é…

#### Phase 4ï¼šç”Ÿæ€æ‰©å±•ï¼ˆ12ä¸ªæœˆï¼‰
- â³ ç¬¬ä¸‰æ–¹å¹³å°é›†æˆ
- â³ APIå¼€æ”¾å¹³å°
- â³ è¡Œä¸šè§£å†³æ–¹æ¡ˆ
- â³ ä¼ä¸šç‰ˆåŠŸèƒ½

---

## ğŸ“š å‚è€ƒèµ„æº

### æŠ€æœ¯æ–‡æ¡£
- [é€šä¹‰åƒé—®APIæ–‡æ¡£](https://help.aliyun.com/document_detail/2399395.html)
- [FastAPIå®˜æ–¹æ–‡æ¡£](https://fastapi.tiangolo.com/)
- [SQLiteæ€§èƒ½ä¼˜åŒ–æŒ‡å—](https://www.sqlite.org/optoverview.html)

### ç›¸å…³è®ºæ–‡
- [Semantic Similarity with BERT](https://arxiv.org/abs/1908.10084)
- [Efficient Vector Search](https://arxiv.org/abs/1603.09320)

### å·¥å…·èµ„æº
- [å‘é‡å¯è§†åŒ–å·¥å…·](https://projector.tensorflow.org/)
- [SQLæŸ¥è¯¢ä¼˜åŒ–å™¨](https://explain.depesz.com/)

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°æŠ€æœ¯é—®é¢˜ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è·å–æ”¯æŒï¼š

1. **æŸ¥çœ‹æ—¥å¿—**ï¼š`/WeiXinKeFu/logs/intent_matcher.log`
2. **è¿è¡Œè¯Šæ–­**ï¼š`python diagnose_intent_system.py`
3. **æäº¤Issue**ï¼š[GitHub Issues](https://github.com/FriendAI/issues)

---

*æœ¬æ–‡æ¡£ä¼šæŒç»­æ›´æ–°ï¼Œæœ€æ–°ç‰ˆæœ¬è¯·æŸ¥çœ‹ [GitHub](https://github.com/FriendAI/)*

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0  
**æœ€åæ›´æ–°**: 2025-01-15  
**ç»´æŠ¤å›¢é˜Ÿ**: FriendAI Technical Team