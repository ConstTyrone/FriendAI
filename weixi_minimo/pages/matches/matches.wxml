<!--åŒ¹é…ç»“æœé¡µé¢-->
<scroll-view class="matches-page {{themeClass}}" scroll-y="{{true}}" bindscroll="onPageScroll" enhanced="{{true}}" show-scrollbar="{{false}}">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="page-header">
    <text class="back-button" bindtap="onBack">â€¹ è¿”å›</text>
    <text class="page-title">{{intentName ? intentName + ' - åŒ¹é…ç»“æœ' : 'åŒ¹é…ç»“æœ'}}</text>
  </view>
  
  <!-- åŒ¹é…ç»“æœåˆ—è¡¨ -->
  <view class="match-list" wx:if="{{matches.length > 0}}">
    <view wx:for="{{matches}}" wx:key="id" class="match-card {{item.isHighlighted ? 'highlighted' : ''}}">
      <!-- åŒ¹é…ä¿¡æ¯ -->
      <view class="match-header">
        <view class="match-title-row">
          <text class="intent-name">{{item.intent_name}}</text>
          <!-- AIæ ‡è¯† -->
          <text class="ai-match-badge" wx:if="{{item.isAIMatch}}">AI</text>
        </view>
        <view class="match-score-row">
          <view class="match-score-container">
            <text class="match-score">{{item.scorePercent}}% åŒ¹é…</text>
            <!-- åŒ¹é…åº¦è¿›åº¦æ¡ -->
            <view class="score-progress">
              <view class="progress-bar" style="width: {{item.scorePercent}}%;"></view>
            </view>
          </view>
          <!-- å‘é‡ç›¸ä¼¼åº¦ -->
          <text class="vector-score" wx:if="{{item.hasVectorSimilarity}}">
            è¯­ä¹‰: {{item.vectorSimilarity}}%
          </text>
        </view>
      </view>
      
      <!-- è”ç³»äººä¿¡æ¯ -->
      <view class="profile-section" bindtap="viewProfile" data-id="{{item.profile_id}}">
        <view class="profile-avatar">
          <text class="avatar-text">{{item.profileInitial}}</text>
        </view>
        
        <view class="profile-info">
          <text class="profile-name">{{item.profile_name || 'æœªçŸ¥'}}</text>
          <text class="profile-title" wx:if="{{item.company || item.position}}">
            {{item.company}}{{item.company && item.position ? ' Â· ' : ''}}{{item.position}}
          </text>
          <text class="profile-location" wx:if="{{item.location}}">{{item.location}}</text>
        </view>
        
        <text class="view-arrow">â€º</text>
      </view>
      
      <!-- åŒ¹é…è§£é‡Š -->
      <view class="match-explanation" wx:if="{{item.explanation}}">
        <text class="explanation-label">åŒ¹é…ç†ç”±ï¼š</text>
        <text class="explanation-text">{{item.explanation}}</text>
      </view>
      
      <!-- åŒ¹é…æ¡ä»¶ -->
      <view class="match-highlights" wx:if="{{item.matched_conditions && item.matched_conditions.length > 0}}">
        <view wx:for="{{item.matched_conditions}}" wx:for-item="condition" wx:key="index" 
              class="highlight-tag">
          <text class="tag-icon">âœ“</text>
          <text class="tag-text">{{condition}}</text>
        </view>
      </view>
      
      <!-- åº•éƒ¨ä¿¡æ¯ -->
      <view class="match-footer">
        <text class="match-time">{{item.createdAtFormat}}</text>
        <view class="match-type-wrapper" wx:if="{{item.matchTypeDisplay}}">
          <text class="match-type-text">{{item.matchTypeDisplay}}</text>
        </view>
      </view>
      
      <!-- åé¦ˆæŒ‰é’®åŒºåŸŸ -->
      <view class="feedback-section">
        <text class="feedback-label">è¿™ä¸ªåŒ¹é…æ€ä¹ˆæ ·ï¼Ÿ</text>
        <view class="feedback-buttons">
          <button 
            class="feedback-btn positive {{item.user_feedback === 'positive' ? 'active' : ''}}" 
            bindtap="submitFeedback" 
            data-match-id="{{item.id}}" 
            data-feedback="positive">
            <text class="feedback-icon">ğŸ‘</text>
            <text class="feedback-text">å¥½åŒ¹é…</text>
          </button>
          <button 
            class="feedback-btn negative {{item.user_feedback === 'negative' ? 'active' : ''}}" 
            bindtap="submitFeedback" 
            data-match-id="{{item.id}}" 
            data-feedback="negative">
            <text class="feedback-icon">ğŸ‘</text>
            <text class="feedback-text">ä¸å‡†ç¡®</text>
          </button>
          <button 
            class="feedback-btn ignored {{item.user_feedback === 'ignored' ? 'active' : ''}}" 
            bindtap="submitFeedback" 
            data-match-id="{{item.id}}" 
            data-feedback="ignored">
            <text class="feedback-icon">â­</text>
            <text class="feedback-text">å¿½ç•¥</text>
          </button>
        </view>
      </view>
    </view>
    
    <!-- é‡æ–°åŒ¹é…æŒ‰é’®ï¼ˆåˆ—è¡¨æœ«å°¾ï¼‰ -->
    <view class="bottom-trigger" wx:if="{{intentId}}">
      <button class="trigger-match-btn" bindtap="triggerMatch">
        é‡æ–°åŒ¹é…
      </button>
    </view>
  </view>
  
  <!-- ç©ºçŠ¶æ€ - ç°ä»£åŒ–è®¾è®¡ -->
  <view class="empty-state" wx:if="{{!loading && matches.length === 0}}">
    <text class="empty-title">æš‚æ— åŒ¹é…ç»“æœ</text>
    <text class="empty-desc">è°ƒæ•´æ„å›¾æ¡ä»¶æˆ–é™ä½åŒ¹é…é˜ˆå€¼ï¼ŒAIä¼šä¸ºæ‚¨æ‰¾åˆ°æ›´å¤šæ½œåœ¨åŒ¹é…</text>
  </view>
  
  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-state" wx:if="{{loading}}">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>
</scroll-view>