<!-- 联系人多选组件 -->
<view class="contact-picker {{visible ? 'show' : 'hide'}}">
  <!-- 遮罩层 -->
  <view class="picker-mask" bind:tap="onCancel"></view>
  
  <!-- 选择器主体 -->
  <view class="picker-container">
    <!-- 头部 -->
    <view class="picker-header">
      <view class="header-title">选择联系人</view>
      <view class="header-subtitle">
        已选择 {{selectedIds.size}}/{{maxCount}} 个联系人
      </view>
    </view>
    
    <!-- 搜索框 -->
    <view class="search-container">
      <input 
        class="search-input" 
        placeholder="搜索联系人姓名或电话"
        bindinput="onSearchInput"
        value="{{searchKeyword}}"
      />
    </view>
    
    <!-- 全选控制 -->
    <view class="select-all-container">
      <view class="select-all-item" bind:tap="onToggleAll">
        <view class="checkbox {{isAllSelected ? 'checked' : ''}}">
          <text class="checkbox-icon">{{isAllSelected ? '✓' : ''}}</text>
        </view>
        <text class="select-all-text">全选当前结果</text>
      </view>
    </view>
    
    <!-- 联系人列表 -->
    <scroll-view class="contact-list" scroll-y="true">
      <view wx:if="{{loading}}" class="loading-container">
        <text class="loading-text">正在加载联系人...</text>
      </view>
      
      <view wx:elif="{{displayContacts.length === 0}}" class="empty-container">
        <text class="empty-text">{{searchKeyword ? '没有找到匹配的联系人' : '暂无联系人'}}</text>
      </view>
      
      <view wx:else>
        <view 
          wx:for="{{displayContacts}}" 
          wx:key="id"
          class="contact-item {{selectedIds.has(item.id) ? 'selected' : ''}}"
          data-id="{{item.id}}"
          bind:tap="onContactToggle"
        >
          <view class="contact-checkbox">
            <view class="checkbox {{selectedIds.has(item.id) ? 'checked' : ''}}">
              <text class="checkbox-icon">{{selectedIds.has(item.id) ? '✓' : ''}}</text>
            </view>
          </view>
          
          <view class="contact-info">
            <view class="contact-name">{{item.name}}</view>
            <view class="contact-phone">{{item.phone}}</view>
          </view>
        </view>
      </view>
    </scroll-view>
    
    <!-- 底部按钮 -->
    <view class="picker-footer">
      <button class="cancel-btn" bind:tap="onCancel">取消</button>
      <button 
        class="confirm-btn {{selectedIds.size > 0 ? 'active' : ''}}" 
        bind:tap="onConfirm"
        disabled="{{selectedIds.size === 0}}"
      >
        确定 ({{selectedIds.size}})
      </button>
    </view>
  </view>
</view>